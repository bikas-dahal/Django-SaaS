name: 2- Test Django Basic 

on:
  workflow_dispatch:
  # schedule:
  # - cron: '0 0 * * *'
  push:
    branches:
      - main


jobs:
  test:
    runs-on: ubuntu-latest
    env:
        DJANGO_DEBUG: 0 
        # DJANGO_SECRET_KEY: not-good
    steps:
     - name: Checkout Code
       uses: actions/checkout@v4
     - name: Setup Python
       uses: actions/setup-python@v5
       with:
         python-version: '3.12'

     - name: Setup Django Secret Key
       run: |
        my_key = $(openssl rand -base64 32)
        echo "DJANGO_SECRET_KEY=$my_key" >> $GITHUB_ENV
     - name: Install Requirements
      #  working-directory: ./src
       run:  |
        python -m pip install --upgrade pip
        python -m pip install -r requirements.txt
     - name: Django Tests
       working-directory: ./src
       
       run:  |
        python manage.py test

      
